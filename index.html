<head>
  <title>space-mission</title>
</head>

<template name="application">
  <div class="wrapper is-paused">
    {{> header}}
    {{> yield}}
    {{> panel}}
  </div>
</template>

<template name="loading">
  Loading
</template>

<template name="header">
  <header class="header">
    <button data-panel-template="addConstellation">Add constellation</button>
    <button class="mtr_add-planet" data-panel-template="addPlanet">Add Planet</button>
  </header>
</template>

<template name="constellations">
  <div class="constellations">
    {{#each constellation}}
      <div class="constellation">
        <div class="constellation__container">
          <div class="systems">
            {{> systems}}
          </div>
        </div>
        <div class="constellation__meta">
          <h2 class="constellation__title">{{title}}</h2>
          <button class="constellation__action" data-panel-template="addSystem">Add system</button>
        </div>
      </div>
    {{/each}}
  </div>
</template>

<template name="systems">
  {{#each system}}
    <a href="{{pathFor route='system'}}"
      class="system {{size}}"
      style="top:{{position.x}}%; left:{{position.y}}%;"
      data-title="{{title}}">
    </a>
  {{/each}}
</template>

<template name="system">
  <div class="planets">
    {{#each planet}}
      <div class="planet__orbit mtr_planet-details"
        data-panel-template="planet"
        style="width: {{width}}%;
               margin-top: -{{margin}}%;
               margin-left: -{{margin}}%;
               z-index: {{zIndex}};
               -webkit-animation-duration: {{duration}}s;
                  -moz-animation-duration: {{duration}}s;
                    -o-animation-duration: {{duration}}s;
                       animation-duration: {{duration}}s;">
        <a class="planet {{size}} mtr_planet-details"
          data-panel-template="planet"
          data-title="{{title}}"
          style="background-image: url('{{background}}');">
        </a>
      </div>
    {{/each}}
    <div class="sun"></div>
  </div>
</template>

<template name="planet">
  {{#each planetDetail}}
    <div class="planet large" style="background-image: url('{{background}}');"></div>
    <h2>{{title}}</h2>
    <p>{{description}}</p>
    <dl>
      <dt>System</dt>
      <dd>{{systemParent}}</dd>
    </dl>
    <dl>
      <dt>Constellation</dt>
      {{#if Template.subscriptionsReady}}
        <dd>{{constellationParent}}</dd>
      {{else}}
        <dd>Loading</dd>
      {{/if}}
    </dl>
    <footer class="panel__footer">
      {{#unless isFinished}}
        {{#if isPaused}}<button class="mtr_start-planet">Start</button>{{/if}}
        {{#if isStarted}}<button class="mtr_pause-planet">Pause</button>{{/if}}
        <button class="mtr_finish-planet">Finish</button>
      {{else}}
        <button class="mtr_start-planet">Restart</button>
      {{/unless}}
    </footer>
  {{/each}}
</template>

<template name="panel">
  {{#if activePanel}}
    <div class="panel">
      <a data-panel="close">close</a>
      {{> UI.dynamic template=activePanel}}
    </div>
  {{/if}}
</template>

<template name="addConstellation">
  <fieldset>
    <label>Title</label>
    <input type="text" id="mtr_constellation-title">
  </fieldset>
  <fieldset>
    <label>Description</label>
    <textarea id="mtr_constellation-description"></textarea>
  </fieldset>
  <button class="mtr_add-constellation">Add constellation</button>
</template>

<template name="addSystem">
  <fieldset>
    <label>Title</label>
    <input type="text" id="mtr_system-title">
  </fieldset>
  <fieldset>
    <label>Description</label>
    <textarea id="mtr_system-description"></textarea>
  </fieldset>
  <fieldset>
    <label>Size</label>
    <select id="mtr_system-size">
      <option value="small">Small</option>
      <option value="medium">Medium</option>
      <option value="large">Large</option>
    </select>
  </fieldset>
  <button class="mtr_add-system">Add system</button>
</template>

<template name="addPlanet">
  <fieldset>
    <label>Title</label>
    <input type="text" id="mtr_planet-title">
  </fieldset>
  <fieldset>
    <label>Description</label>
    <textarea id="mtr_planet-description"></textarea>
  </fieldset>
  <fieldset>
    <label>Size</label>
    <select id="mtr_planet-size">
      <option value="small">Small</option>
      <option value="medium">Medium</option>
      <option value="large">Large</option>
    </select>
  </fieldset>
  <button class="mtr_add-planet">Add planet</button>
</template>

